% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/dominance.attribution.R
\name{EfficientDominanceSummary}
\alias{EfficientDominanceSummary}
\title{Group-wise dominance summary: stable vs opportunistic dominance
For each taxon within each group, this function summarizes dominance
patterns based on a rank matrix. It computes:
\itemize{
\item \code{Borda_norm}: normalized Borda score in \link{0, 1}, measuring
average dominance level across samples in the group;
\item \code{RankEntropy_norm}: normalized rank entropy in \link{0, 1},
measuring instability/variability of dominance ranks;
\item \code{StableDominance}: \code{Borda_norm * (1 - RankEntropy_norm)},
capturing taxa that are both dominant and stably ranked;
\item \code{OpportunisticDominance}: \code{Borda_norm * RankEntropy_norm},
capturing taxa that are dominant but fluctuate strongly across samples.
}}
\usage{
EfficientDominanceSummary(rank_matrix, metadata, group_var, physeq = NULL)
}
\arguments{
\item{rank_matrix}{A numeric matrix of taxa x samples containing rank
information (e.g., output from \code{\link{Dominance.rank}}), where
smaller ranks correspond to more dominant taxa. Rows are taxa and
columns are samples.}

\item{metadata}{A \code{data.frame} with row names matching the sample
IDs (column names of \code{rank_matrix}), containing grouping
variables.}

\item{group_var}{Character string; the column name in \code{metadata}
specifying the grouping factor.}

\item{physeq}{Optional \code{phyloseq} object. If provided, the taxonomy
table (\code{tax_table(physeq)}) will be joined to the output by taxon
name.}
}
\value{
A \code{data.frame} with one row per taxon per group, containing:
\itemize{
\item \code{Taxon}: taxon ID (row name of \code{rank_matrix});
\item \code{Group}: group label;
\item \code{Borda_norm}: normalized Borda score in \link{0, 1};
\item \code{RankEntropy_norm}: normalized rank entropy in \link{0, 1};
\item \code{StableDominance}: stable dominance index;
\item \code{OpportunisticDominance}: opportunistic dominance index;
\item additional taxonomy columns if \code{physeq} is provided.
}
}
\description{
Optionally, taxonomy information can be merged if a \code{phyloseq}
object is provided.
}
\details{
For a given group \eqn{g} with \eqn{n_g} samples and \eqn{K} taxa:
\itemize{
\item \strong{Normalized Borda}:
\deqn{
      \text{Borda}_i = \sum_{s \in g} (K - \text{rank}_{i,s}), \quad
      \text{Borda\_norm}_i =
        \frac{\text{Borda}_i}{n_g (K - 1)} \in [0, 1],
    }
where values close to 1 indicate consistently high dominance ranks.

\item \strong{Normalized rank entropy}:
Let \eqn{p_{i,r}} be the empirical frequency of rank \eqn{r} for taxon
\eqn{i} within group \eqn{g}, and
\deqn{
      H_i = -\sum_r p_{i,r}\log_2(p_{i,r})
    }
be the Shannon entropy of the rank distribution. The maximum possible
entropy is approximated as:
\deqn{
      H_{\max} = \log_2(\min(K, n_g)),
    }
and the normalized rank entropy is
\deqn{
      \text{RankEntropy\_norm}_i =
        \begin{cases}
          H_i / H_{\max}, & H_{\max} > 0, \\
          0, & H_{\max} = 0.
        \end{cases}
    }
Values near 0 indicate stable ranks across samples, while values near
1 indicate highly variable ranks.

\item \strong{Stable dominance}:
\deqn{
      \text{StableDominance}_i = \text{Borda\_norm}_i
                                \cdot (1 - \text{RankEntropy\_norm}_i),
    }
high when a taxon is both strongly and stably dominant.

\item \strong{Opportunistic dominance}:
\deqn{
      \text{OpportunisticDominance}_i = \text{Borda\_norm}_i
                                       \cdot \text{RankEntropy\_norm}_i,
    }
high when a taxon is often dominant but with highly fluctuating ranks,
resembling opportunistic or bloom-like behaviour.
}
}
\examples{
\dontrun{
library(dplyr)

set.seed(1)
K <- 10; n <- 20
rank_mat <- matrix(
  sample(1:K, K * n, replace = TRUE),
  nrow = K, ncol = n
)
rownames(rank_mat) <- paste0("Taxon_", 1:K)
colnames(rank_mat) <- paste0("Sample_", 1:n)

meta <- data.frame(
  Group = rep(c("A", "B"), each = 10),
  row.names = colnames(rank_mat)
)

res <- EfficientDominanceSummary(
  rank_matrix = rank_mat,
  metadata = meta,
  group_var = "Group"
)

head(res)
}
}
